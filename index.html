<!DOCTYPE HTML>
<html lang="ru">
    <head>
        <meta charset="UTF-8">
        <title>VueJS</title>
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/main.css">
    </head>
    <body>
        <div id="page">

            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container">
                    <a
                        class="navbar-brand"
                        href="javascript:void(0);"
                        @click="search = ''"
                    >
                        Test <b class="text-success">Vue.js</b>
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample07" aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navbarsExample07">
                        <ul class="navbar-nav mr-auto">
                            <li 
                                v-for="make in makes"
                                class="nav-$item"
                            >
                                <a
                                    class="nav-link"
                                    href="javascript:void(0);"
                                    @click="search = make"
                                    :class="{'active': search === make}"
                                >
                                    {{ make }}
                                </a>
                            </li>
                        </ul>
                        <form class="form-inline my-2 my-md-0">
                            <input
                                class="form-control"
                                type="text"
                                placeholder="Поиск"
                                v-model="search"
                            >
                        </form>
                    </div>
                </div>
            </nav>

            <div class="py-4 bg-light">
                <div class="container">
                    <div class="row">

                        <div
                            v-for="(car, index) in filterCars"
                            class="col-md-6 col-lg-4">
                            <div class="card mb-4 box-shadow">
                                <img
                                    :src="'img/' + car.img"
                                    v-bind:alt="car.make + ' ' + car.model"
                                >
                                <div class="card-body p-3">
                                    <h5 class="card-title mb-2 font-weight-bold">{{ car.make }} {{ car.model }}</h5>
                                    <ul class="list-group mb-2">
                                        <li class="rst-d-ib">Цена: <b class="text-danger">{{ car.price }} грн.</b></li>
                                        <li><span class="rst-d-ib">Год: <b class="year">{{ car.year }}</b></span>, <span class="rst-d-ib">(<i class="run">{{ car.run }}</i> - пробег)</span></li>
                                        <li><span class="rst-d-ib">Двиг.: <b class="engine">{{ car.engine }}</b>,</span> <span class="rst-d-ib"><i class="fuel">{{ car.fuel }}</i> (<b class="gear">{{ car.gear }}</b>)</span></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-$items-center">
                                        <a
                                            href="tel:+380971234567"
                                            class="btn btn-secondary btn-lg tel"
                                            v-if="phoneVisibility === index"
                                        >
                                            +38(097)12-34-567
                                        </a>
                                        <button
                                            class="btn btn-outline-success"
                                            v-if="phoneVisibility !== index"
                                            @click="phoneVisibility = index"
                                        >
                                            Показать телефон
                                        </button>
                                        <button
                                            class="btn btn-primary ml-a"
                                            @click="modalVisibility = true"
                                        >
                                            Купить
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
            <div
                class="modal bd-example-modal-lg fade show"
                tabindex="-1"
                role="dialog"
                v-if="modalVisibility"
                >
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Корзина</h5>
                            <button
                                type="button"
                                class="close"
                                data-dismiss="modal"
                                aria-label="Close"
                                @click="modalVisibility = false"
                            >
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body p-0">
                            <table class="table mb-0">
                                <tbody>
                                    <tr
                                        v-for="basket in baskets"
                                    >
                                        <td class="align-middle col-2">{{ cars[basket.id].make }} {{ cars[basket.id].model }}</td>
                                        <td class="align-middle col-2">{{ cars[basket.id].price }} грн.</td>
                                        <td class="align-middle col-3">
                                            <div class="input-group mb-1 mt-1">
                                              <div class="input-group-prepend">
                                                <button class="btn btn-outline-secondary" type="button"
                                                    @click="basket.quantity = basket.quantity - 1 <=0 ? 1 : basket.quantity - 1"
                                                >-</button>
                                              </div>
                                              <input
                                                type="text" class="form-control"
                                                :value="basket.quantity"
                                              >
                                              <div class="input-group-append">
                                                <button class="btn btn-outline-secondary" type="button"
                                                    @click="basket.quantity += 1"
                                                >+</button>
                                              </div>
                                            </div>
                                        </td>
                                        <td class="align-middle col-2">{{ cars[basket.id].price + basket.quantity }} грн.</td>
                                    </tr>
                                    <tr>
                                        <td colspan="4" class="text-success text-right"><b>Итого:</b> <span></span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer d-flex justify-content-between align-items-end">
                            <button
                            type="button"
                            class="btn btn-outline-secondary"
                            data-dismiss="modal"
                            @click="modalVisibility = false"
                            >Продолжить покупки</button>
                            <button type="button" class="btn btn-primary">Оформить заказ</button>
                        </div>
                    </div>
                </div>
            </div>
            <div
                class="modal-backdrop fade show"
                v-if="modalVisibility"
            ></div>


            <footer class="text-muted pt-5 pb-5">
                <div class="container">
                    <p class="float-right">
                        <a href="#">Back to top</a>
                    </p>
                    <p>© MishaKokhanych</p>
                </div>
            </footer>

        </div>

        <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
        <script src="data.js"></script> //для локальной версии
        <script src="js/main.js"></script>
    </body>
</html>